name: Dynamic Web Scraping

# ì›Œí¬í”Œë¡œ ì‹¤í–‰ ì¡°ê±´
# 1. 'main' ë¸Œëœì¹˜ì— ì½”ë“œê°€ í‘¸ì‹œë  ë•Œ ì‹¤í–‰
# 2. ë§¤ì¼ ìƒˆë²½ 3ì‹œ 30ë¶„(UTC ê¸°ì¤€)ì— ì‹¤í–‰
on:
  push:
    branches:
      - main
  schedule:
    - cron: '30 3 * * *'

jobs:
  run-scrapers:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.x'
      
      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install selenium webdriver-manager openpyxl
          # ë§Œì•½ driver_utils.pyê°€ ë³„ë„ íŒŒì¼ë¡œ ìˆë‹¤ë©´, í•´ë‹¹ íŒŒì¼ì„ importí•  ìˆ˜ ìˆë„ë¡ ê²½ë¡œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

      - name: Run Music Scraper
        run: python music_scroll.py

      - name: Run SNS Scraper
        run: python sns_scrap.py

      - name: Run Poll Scraper
        run: python poll_scraper.py
        
      # ìƒì„±ëœ ì—‘ì…€ íŒŒì¼ì„ ì»¤ë°‹í•˜ì—¬ ì €ì¥ì†Œì— ì—…ë°ì´íŠ¸
      - name: Commit and Push Excel Files
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add *.xlsx
          git commit -m "ğŸ¤– Update data files from scraper" || echo "No changes to commit"
          git push